import { useState, useEffect } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport Navbar from \"@/components/Navbar\";\nimport Footer from \"@/components/Footer\";\nimport { CreditCard, CheckCircle, Phone, Mail, User } from \"lucide-react\";\n\ninterface Product {\n  id: number;\n  name: string;\n  description: string;\n  interest_rate: string;\n  processing_fee: string;\n  eligibility: string;\n  features: string[];\n}\n\nconst CreditCards = () => {\n  const [products, setProducts] = useState<Product[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [selectedProduct, setSelectedProduct] = useState<Product | null>(null);\n  const [showForm, setShowForm] = useState(false);\n  const { toast } = useToast();\n  \n  const [formData, setFormData] = useState({\n    name: \"\",\n    mobile: \"\",\n    email: \"\"\n  });\n\n  useEffect(() => {\n    fetchProducts();\n  }, []);\n\n  const fetchProducts = async () => {\n    try {\n      const response = await fetch('https://api.finonest.com/api/products', {\n        headers: {\n          'X-API-Key': 'FINONEST_API_KEY_2024'\n        }\n      });\n      const data = await response.json();\n      if (data.success) {\n        setProducts(data.products);\n      }\n    } catch (error) {\n      console.error('Failed to fetch products:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleApply = (product: Product) => {\n    setSelectedProduct(product);\n    setShowForm(true);\n  };\n\n  const submitLead = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!selectedProduct) return;\n    \n    try {\n      const response = await fetch('https://api.finonest.com/api/leads', {\n        method: 'POST',\n        headers: {\n          'X-API-Key': 'FINONEST_API_KEY_2024',\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          ...formData,\n          product_id: selectedProduct.id,\n          channel_code: 'WEBSITE_CREDIT_CARD'\n        })\n      });\n      \n      const data = await response.json();\n      \n      if (response.ok && data.success) {\n        toast({\n          title: \"Application Submitted!\",\n          description: \"We'll contact you within 24 hours.\",\n        });\n        setFormData({ name: \"\", mobile: \"\", email: \"\" });\n        setShowForm(false);\n        setSelectedProduct(null);\n      } else {\n        toast({\n          title: \"Error\",\n          description: data.error || \"Failed to submit application\",\n          variant: \"destructive\",\n        });\n      }\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Network error occurred\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  if (loading) {\n    return (\n      <>\n        <Navbar />\n        <div className=\"min-h-screen flex items-center justify-center\">\n          <div className=\"animate-pulse text-muted-foreground\">Loading credit cards...</div>\n        </div>\n      </>\n    );\n  }\n\n  return (\n    <>\n      <Navbar />\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100\">\n        {/* Hero Section */}\n        <div className=\"bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-12 px-4\">\n          <div className=\"max-w-4xl mx-auto text-center\">\n            <CreditCard className=\"w-16 h-16 mx-auto mb-4\" />\n            <h1 className=\"text-3xl md:text-4xl font-bold mb-4\">Credit Cards</h1>\n            <p className=\"text-lg md:text-xl text-blue-100\">Choose the perfect credit card for your lifestyle</p>\n          </div>\n        </div>\n\n        {/* Products Grid */}\n        <div className=\"max-w-6xl mx-auto px-4 py-8\">\n          <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\n            {products.map((product) => (\n              <Card key={product.id} className=\"hover:shadow-lg transition-shadow\">\n                <CardHeader className=\"pb-4\">\n                  <CardTitle className=\"flex items-center gap-2 text-lg\">\n                    <CreditCard className=\"w-5 h-5 text-blue-600\" />\n                    {product.name}\n                  </CardTitle>\n                  <p className=\"text-sm text-muted-foreground\">{product.description}</p>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"space-y-2\">\n                    <div className=\"flex justify-between text-sm\">\n                      <span className=\"font-medium\">Interest Rate:</span>\n                      <Badge variant=\"outline\">{product.interest_rate}</Badge>\n                    </div>\n                    <div className=\"flex justify-between text-sm\">\n                      <span className=\"font-medium\">Processing Fee:</span>\n                      <span className=\"text-green-600 font-medium\">{product.processing_fee}</span>\n                    </div>\n                  </div>\n                  \n                  <div>\n                    <p className=\"text-sm font-medium mb-2\">Key Features:</p>\n                    <div className=\"space-y-1\">\n                      {product.features.slice(0, 3).map((feature, index) => (\n                        <div key={index} className=\"flex items-center gap-2 text-sm\">\n                          <CheckCircle className=\"w-3 h-3 text-green-500\" />\n                          <span>{feature}</span>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                  \n                  <div className=\"pt-2\">\n                    <p className=\"text-xs text-muted-foreground mb-3\">\n                      <strong>Eligibility:</strong> {product.eligibility}\n                    </p>\n                    <Button \n                      onClick={() => handleApply(product)} \n                      className=\"w-full bg-blue-600 hover:bg-blue-700\"\n                    >\n                      Apply Now\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </div>\n\n        {/* Application Form Modal */}\n        {showForm && selectedProduct && (\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\n            <Card className=\"w-full max-w-md\">\n              <CardHeader>\n                <CardTitle className=\"text-center\">\n                  Apply for {selectedProduct.name}\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <form onSubmit={submitLead} className=\"space-y-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium mb-2\">\n                      <User className=\"w-4 h-4 inline mr-1\" />\n                      Full Name *\n                    </label>\n                    <Input\n                      value={formData.name}\n                      onChange={(e) => setFormData({...formData, name: e.target.value})}\n                      placeholder=\"Enter your full name\"\n                      required\n                    />\n                  </div>\n                  <div>\n                    <label className=\"block text-sm font-medium mb-2\">\n                      <Phone className=\"w-4 h-4 inline mr-1\" />\n                      Mobile Number *\n                    </label>\n                    <Input\n                      type=\"tel\"\n                      value={formData.mobile}\n                      onChange={(e) => setFormData({...formData, mobile: e.target.value})}\n                      placeholder=\"9876543210\"\n                      required\n                    />\n                  </div>\n                  <div>\n                    <label className=\"block text-sm font-medium mb-2\">\n                      <Mail className=\"w-4 h-4 inline mr-1\" />\n                      Email Address *\n                    </label>\n                    <Input\n                      type=\"email\"\n                      value={formData.email}\n                      onChange={(e) => setFormData({...formData, email: e.target.value})}\n                      placeholder=\"your@email.com\"\n                      required\n                    />\n                  </div>\n                  <div className=\"flex gap-2 pt-4\">\n                    <Button type=\"submit\" className=\"flex-1 bg-blue-600 hover:bg-blue-700\">\n                      Submit Application\n                    </Button>\n                    <Button \n                      type=\"button\" \n                      variant=\"outline\" \n                      onClick={() => {\n                        setShowForm(false);\n                        setSelectedProduct(null);\n                        setFormData({ name: \"\", mobile: \"\", email: \"\" });\n                      }}\n                    >\n                      Cancel\n                    </Button>\n                  </div>\n                </form>\n              </CardContent>\n            </Card>\n          </div>\n        )}\n      </div>\n      <Footer />\n    </>\n  );\n};\n\nexport default CreditCards;